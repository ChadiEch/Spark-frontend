import{n as j,r as f,u as B,b as _,c as z,o as V,p as G,E as N,H as U,M as q,q as J,j as e,P as v,a as r,g as H,R as h,s as m,C as l,B as d,S as b,T as y,I as Q,v as W,U as X,w as Y}from"./index-DIr9oKOl.js";const Z=j("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);const x=j("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);const ee=j("ChartNoAxesColumnIncreasing",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]),le=()=>{const[p,se]=f.useState("30"),[c,o]=f.useState("overview"),w=B(),{posts:k,loading:T}=_(),t=k||[],{campaigns:g}=z();V();const{data:n,isLoading:C}=G({queryKey:["analyticsReport",p],queryFn:()=>Y.getDetailedReport()}),u=t.reduce((s,a)=>s+(a.metrics?.reach||0),0),R=t.reduce((s,a)=>s+(a.metrics?.likes||0)+(a.metrics?.comments||0)+(a.metrics?.shares||0),0),A=t.length>0?R/u*100:0,M=t.reduce((s,a)=>s+(a.metrics?.likes||0)+(a.metrics?.comments||0)+(a.metrics?.shares||0)+(a.metrics?.saves||0),0),S=g.reduce((s,a)=>s+(a.budgetCents||0),0)/100,K=[{title:"Total Reach",value:`${(u/1e6).toFixed(1)}M`,change:"+15.3%",trend:"up",icon:N,color:"text-blue-500"},{title:"Engagement Rate",value:`${A.toFixed(1)}%`,change:"+2.1%",trend:"up",icon:U,color:"text-red-500"},{title:"Total Interactions",value:`${(M/1e3).toFixed(1)}K`,change:"+8.7%",trend:"up",icon:q,color:"text-green-500"},{title:"Revenue Generated",value:`$${(S/1e3).toFixed(1)}K`,change:"-3.2%",trend:"down",icon:J,color:"text-yellow-500"}],P=g.map(s=>({id:s.id,name:s.name,reach:s.goals.reduce((a,i)=>typeof i=="string"?a:a+(i.currentValue||0),0),engagement:Math.floor(Math.random()*5e4),conversions:Math.floor(Math.random()*500),roi:Math.floor(Math.random()*400),status:s.status.toLowerCase()})),I=[{platform:"Instagram",followers:"125K",reach:`${Math.floor(t.filter(s=>s.platform==="INSTAGRAM").reduce((s,a)=>s+(a.metrics?.reach||0),0)/1e3)}K`,engagement:`${(t.filter(s=>s.platform==="INSTAGRAM").reduce((s,a)=>s+(a.metrics?.likes||0),0)/t.filter(s=>s.platform==="INSTAGRAM").reduce((s,a)=>s+(a.metrics?.reach||1),0)*100).toFixed(1)}%`,posts:t.filter(s=>s.platform==="INSTAGRAM").length,color:"bg-pink-500"},{platform:"TikTok",followers:"87K",reach:`${Math.floor(t.filter(s=>s.platform==="TIKTOK").reduce((s,a)=>s+(a.metrics?.reach||0),0)/1e3)}K`,engagement:`${(t.filter(s=>s.platform==="TIKTOK").reduce((s,a)=>s+(a.metrics?.likes||0),0)/t.filter(s=>s.platform==="TIKTOK").reduce((s,a)=>s+(a.metrics?.reach||1),0)*100).toFixed(1)}%`,posts:t.filter(s=>s.platform==="TIKTOK").length,color:"bg-black"},{platform:"Facebook",followers:"45K",reach:`${Math.floor(t.filter(s=>s.platform==="FACEBOOK").reduce((s,a)=>s+(a.metrics?.reach||0),0)/1e3)}K`,engagement:`${(t.filter(s=>s.platform==="FACEBOOK").reduce((s,a)=>s+(a.metrics?.likes||0),0)/t.filter(s=>s.platform==="FACEBOOK").reduce((s,a)=>s+(a.metrics?.reach||1),0)*100).toFixed(1)}%`,posts:t.filter(s=>s.platform==="FACEBOOK").length,color:"bg-blue-600"}],$=[...t].sort((s,a)=>{const i=(s.metrics?.likes||0)+(s.metrics?.comments||0)+(s.metrics?.shares||0);return(a.metrics?.likes||0)+(a.metrics?.comments||0)+(a.metrics?.shares||0)-i}).slice(0,3).map(s=>({id:s.id,title:s.title,platform:s.platform,reach:s.metrics?.reach||0,engagement:(s.metrics?.likes||0)+(s.metrics?.comments||0)+(s.metrics?.shares||0),date:s.createdAt?new Date(s.createdAt).toLocaleDateString():"N/A"})),D=()=>{w("/goals")},E=s=>{console.log("Viewing details for campaign:",s)},O=s=>{console.log("Editing campaign:",s)},F=s=>{console.log("Deleting campaign:",s)},L=s=>{console.log("Viewing details for content:",s)};return T?e.jsx(v,{children:e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"Loading analytics..."})]})})}):e.jsx(v,{children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-3xl font-bold gradient-text",children:"Analytics"}),e.jsx("p",{className:"text-muted-foreground",children:"Track performance metrics across all campaigns and platforms"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(r,{variant:"outline",className:"gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),"Last ",p," Days"]}),e.jsx(h,{resource:"analytics",permission:"view",fallback:e.jsx(m,{data:t,dataType:"posts",fileName:`analytics_report_${new Date().toISOString().split("T")[0]}`,disabled:!0}),children:e.jsx(m,{data:t,dataType:"posts",fileName:`analytics_report_${new Date().toISOString().split("T")[0]}`})})]})]}),e.jsxs("div",{className:"flex space-x-1 bg-muted rounded-lg p-1",children:[e.jsx(r,{variant:c==="overview"?"default":"ghost",className:`flex-1 ${c==="overview"?"bg-gradient-primary":""}`,onClick:()=>o("overview"),children:"Overview"}),e.jsx(r,{variant:c==="reports"?"default":"ghost",className:`flex-1 ${c==="reports"?"bg-gradient-primary":""}`,onClick:()=>o("reports"),children:"Reports"}),e.jsx(r,{variant:c==="user-activity"?"default":"ghost",className:`flex-1 ${c==="user-activity"?"bg-gradient-primary":""}`,onClick:()=>o("user-activity"),children:"User Activity"})]}),c==="overview"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:K.map((s,a)=>{const i=s.icon;return e.jsxs(l,{className:"p-6 bg-gradient-card shadow-card border-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:s.title}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:s.value})]}),e.jsx("div",{className:`p-3 rounded-lg ${s.color} bg-opacity-10`,children:e.jsx(i,{className:`w-6 h-6 ${s.color}`})})]}),e.jsxs("div",{className:"flex items-center mt-4",children:[e.jsxs("span",{className:`text-sm font-medium ${s.trend==="up"?"text-success":"text-destructive"}`,children:[s.trend==="up"?e.jsx(x,{className:"w-4 h-4 inline mr-1"}):e.jsx(Z,{className:"w-4 h-4 inline mr-1"}),s.change]}),e.jsx("span",{className:"text-sm text-muted-foreground ml-2",children:"vs last period"})]})]},a)})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(l,{className:"p-6 bg-gradient-card shadow-card border-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Campaign Performance"}),e.jsx(r,{variant:"outline",size:"sm",onClick:D,children:"View All"})]}),e.jsx("div",{className:"space-y-4",children:P.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium",children:s.name}),e.jsx(d,{variant:s.status==="active"?"default":s.status==="at_risk"?"destructive":"secondary",className:"text-xs",children:s.status})]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Reach: ",s.reach.toLocaleString()]}),e.jsxs("span",{children:["Engagement: ",s.engagement.toLocaleString()]}),e.jsxs("span",{children:["ROI: ",s.roi,"%"]})]})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>E(s.id),children:e.jsx(N,{className:"w-4 h-4"})}),e.jsx(h,{resource:"campaigns",permission:"edit",fallback:e.jsx(r,{variant:"ghost",size:"sm",disabled:!0,children:e.jsx(b,{className:"w-4 h-4"})}),children:e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>O(s.id),children:e.jsx(b,{className:"w-4 h-4"})})}),e.jsx(h,{resource:"campaigns",permission:"delete",fallback:e.jsx(r,{variant:"ghost",size:"sm",disabled:!0,children:e.jsx(y,{className:"w-4 h-4"})}),children:e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>F(s.id),children:e.jsx(y,{className:"w-4 h-4"})})})]})]},s.id))})]}),e.jsxs(l,{className:"p-6 bg-gradient-card shadow-card border-0",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Platform Metrics"}),e.jsx("div",{className:"space-y-4",children:I.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${s.color}`}),e.jsx("span",{className:"font-medium",children:s.platform})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsxs("span",{children:[s.followers," followers"]}),e.jsxs("span",{children:[s.reach," reach"]}),e.jsxs("span",{children:[s.engagement," engagement"]}),e.jsxs("span",{children:[s.posts," posts"]})]})]},a))})]})]}),e.jsxs(l,{className:"p-6 bg-gradient-card shadow-card border-0",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Top Performing Content"}),e.jsx("div",{className:"space-y-4",children:$.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium",children:s.title}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(Q,{className:"w-4 h-4 mr-1"}),s.platform]}),e.jsxs("span",{children:["Reach: ",s.reach.toLocaleString()]}),e.jsxs("span",{children:["Engagement: ",s.engagement.toLocaleString()]}),e.jsx("span",{children:s.date})]})]}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>L(s.id),children:"View Details"})]},s.id))})]})]}),c==="reports"&&e.jsxs(l,{className:"p-6 bg-gradient-card shadow-card border-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Detailed Analytics Report"}),e.jsx(m,{data:t,dataType:"posts",fileName:`detailed_analytics_report_${new Date().toISOString().split("T")[0]}`})]}),C?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"Generating detailed report..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100 text-blue-600",children:e.jsx(ee,{className:"w-5 h-5"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Posts"}),e.jsx("p",{className:"text-xl font-bold",children:n?.data?.data?.metrics?.totalPosts||0})]})]})}),e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 rounded-lg bg-green-100 text-green-600",children:e.jsx(W,{className:"w-5 h-5"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Engagement Rate"}),e.jsxs("p",{className:"text-xl font-bold",children:[n?.data?.data?.metrics?.engagementRate?.toFixed(2)||0,"%"]})]})]})}),e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 rounded-lg bg-purple-100 text-purple-600",children:e.jsx(X,{className:"w-5 h-5"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Reach"}),e.jsxs("p",{className:"text-xl font-bold",children:[(n?.data?.data?.metrics?.totalReach/1e3).toFixed(1)||0,"K"]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(l,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Platform Distribution"}),e.jsx("div",{className:"space-y-3",children:Object.entries(n?.data?.data?.platformDistribution||{}).map(([s,a])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:s}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[a.count," posts"]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[a.engagement.toLocaleString()," engagement"]})]})]},s))})]}),e.jsxs(l,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Top Performing Posts"}),e.jsx("div",{className:"space-y-3",children:(n?.data?.data?.topPosts||[]).slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.title}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(d,{variant:"secondary",className:"text-xs",children:s.platform}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[s.engagementRate.toFixed(1),"% ER"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium",children:s.engagement.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"engagement"})]})]},s.id))})]})]}),e.jsxs(l,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Campaign Performance"}),e.jsx("div",{className:"space-y-4",children:(n?.data?.data?.campaignPerformance||[]).map(s=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsx(d,{variant:s.status==="ACTIVE"?"default":"secondary",className:"text-xs",children:s.status})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[e.jsx("span",{children:"Overall Progress"}),e.jsxs("span",{children:[s.overallProgress.toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx("div",{className:"bg-primary h-2 rounded-full",style:{width:`${s.overallProgress}%`}})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:(s.goalsProgress||[]).map((a,i)=>e.jsxs("div",{className:"bg-muted/50 rounded p-3",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:a.title}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[a.progress.toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-1.5",children:e.jsx("div",{className:"bg-green-500 h-1.5 rounded-full",style:{width:`${a.progress}%`}})}),e.jsxs("div",{className:"flex items-center justify-between text-xs mt-1",children:[e.jsx("span",{children:a.current.toLocaleString()}),e.jsx("span",{children:a.target.toLocaleString()})]})]})]},i))})]},s.id))})]})]})]}),c==="user-activity"&&e.jsxs(l,{className:"p-6 bg-gradient-card shadow-card border-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"User Activity Metrics"}),e.jsx(m,{data:[],dataType:"users",fileName:`user_activity_report_${new Date().toISOString().split("T")[0]}`})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-3 px-4",children:"User"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Role"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Posts"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Reach"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Engagement"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Engagement Rate"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary flex items-center justify-center text-white text-xs font-medium",children:"JD"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"font-medium",children:"John Doe"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"john@example.com"})]})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(d,{variant:"secondary",children:"Admin"})}),e.jsx("td",{className:"py-3 px-4",children:"24"}),e.jsx("td",{className:"py-3 px-4",children:"1.2M"}),e.jsx("td",{className:"py-3 px-4",children:"45.6K"}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2",children:"4.2%"}),e.jsx(x,{className:"w-4 h-4 text-success"})]})})]}),e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white text-xs font-medium",children:"SJ"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"font-medium",children:"Sarah Johnson"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"sarah@example.com"})]})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(d,{variant:"secondary",children:"Content Manager"})}),e.jsx("td",{className:"py-3 px-4",children:"18"}),e.jsx("td",{className:"py-3 px-4",children:"890K"}),e.jsx("td",{className:"py-3 px-4",children:"32.1K"}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2",children:"3.8%"}),e.jsx(x,{className:"w-4 h-4 text-success"})]})})]}),e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center text-white text-xs font-medium",children:"MP"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"font-medium",children:"Mike Peterson"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"mike@example.com"})]})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(d,{variant:"secondary",children:"Team Member"})}),e.jsx("td",{className:"py-3 px-4",children:"12"}),e.jsx("td",{className:"py-3 px-4",children:"450K"}),e.jsx("td",{className:"py-3 px-4",children:"18.7K"}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2",children:"4.1%"}),e.jsx(x,{className:"w-4 h-4 text-success"})]})})]})]})]})})]})]})})};export{le as default};
